version: 0.2

phases:
  install:
    runtime-versions:
      python: 3.11  # Replace with your Python version
    commands:
      - echo "Installing dependencies..."
      - pip install -r requirements.txt  # Install dependencies
      - echo "Dependencies installed."

  pre_build:
    commands:
      - echo "Running pre-build phase..."
      - docker --version                 # Check Docker version to ensure Docker is installed
      - echo "Docker is installed."

  build:
    commands:
      - echo "Building the Docker image..."
      - docker build -t demo_calcu_python:latest .  # Build the Docker image using Dockerfile
      - echo "Docker image build complete."

  post_build:
    commands:
      - echo "Post-build phase:Docker image ready."
      - echo "Build complete."

artifacts:  # This should be outside the phases block
  files:
    - '**/*'
    - '!tests/*'       # Exclude tests folder if not needed
    - '!README.md'     # Exclude README from deployment if not required
    - '!requirements.txt'  # Exclude requirements.txt if not needed
    - '!Dockerfile'    # Exclude Dockerfile if not required

cache:
  paths:
    - '/root/.cache/pip'  # Cache pip dependencies
